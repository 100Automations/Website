<!-- This will be where automations are displayed on the home page -->
<div class="automations">
  <div class="ato_grid mdl-grid">
    <!-- Jekyll loops through our automation collection -->
    {% for automation in site.automations %}
    <div class="full-ato-card">
      <button id="button_{{ forloop.index }}" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect button-needs">
        Needs Help
      </button>
      <div class="ato_cell mdl-cell mdl-cell--4-col">
        <!-- Each card that is created will have a unique id accessed though the forloop.index-->
        <div id="card_{{forloop.index}}" class="ato_card mdl-card mdl-shadow--2dp">
          <!-- A list of needs that will display when the user clicks on it -->
          <!-- Note, we will be able to access the automation.needs and loop through them for display-->
          <div class="ato_needs mdl-card__menu">
            <ul id="needs_{{ forloop.index }}" class="needs_list d-none">
              {% for item in automation.needs %}
                <li>{{ item | capitalize }}</li>
              {% endfor %}
            </ul>
          </div>
          <!-- This is our image that we access through our own API -->
          <!-- The image folder is located in our assets -->
          <div class="ato_card-media mdl-card__media">
            <img src="{{ automation.image }}" alt="{{ automation.title }}">
          </div>
          <div class="ato_card-title mdl-card__title mdl-card--expand">
            <h2 class="mdl-card__title-text">{{ automation.title }}</h2>
          </div>
          <div class="ato_card-text mdl-card__supporting-text">
            <div>
              {{ automation.description }}
            </div>
          </div>
        <div class="ato_card-actions mdl-card__actions mdl-card--border">
          <!-- Automation Readme url is located in links index 1 -->
          <!-- We will need to design a README.md button -->
          <a href="{{ automation.links[1].url }}"
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
            ReadMe <i class="fa fa-github"></i>
          </a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  const toggleList = () => {
    needs_id = event.currentTarget.id.replace("button_", "needs_");
    document.getElementById(needs_id).classList.toggle('d-none');
  }
  Array.from(document.querySelectorAll('.button-needs')).forEach((button) => {
    button.addEventListener('click', toggleList);
  })
</script>